"use strict";(self.webpackChunkfileon=self.webpackChunkfileon||[]).push([[426],{46426:function(N,b,a){a.r(b),a.d(b,{AuthModule:function(){return J}});var C=a(61116),s=a(31041),h=a(60649),Z=a(18971),O=a(50755),p=a(61904),y=a(14322),u=a(64762),l=a(71412),M=a(32041),A=a(14324),P=a(91681),n=a(16942),d="credentials",T=function(){function t(){this._credentials=null,this.sessionStorage=l.Nq.makeStorage(!1,"credentials"),this.localStorage=l.Nq.makeStorage(!0,"credentials");var r=this.sessionStorage.get(d)||this.localStorage.get(d);r&&(this._credentials=JSON.parse(r))}return t.prototype.isAuthenticated=function(){return!!this.credentials},Object.defineProperty(t.prototype,"credentials",{get:function(){return this._credentials},enumerable:!1,configurable:!0}),t.prototype.setCredentials=function(r,o){this._credentials=r||null,r?(o?this.localStorage:this.sessionStorage).set(d,JSON.stringify(r)):(this.sessionStorage.delete(d),this.localStorage.delete(d),document.cookie="X-AUTH-TOKEN=;max-age=0")},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac=function(o){return new(o||t)},providedIn:"root"}),t}(),S=a(42693),m=new l.Yd("AuthenticationService"),k=function(){function t(r,o,e){var i=this;this.credentialsService=r,this.http=o,this.globalService=e,this.globalService.logout$.pipe((0,A.w)(function(c){return i.logout()})).subscribe({next:function(){m.info("Logged out.")}})}return t.prototype.login=function(r){var o=this;return this.http.post("/api/auth/token",{userName:r.username,password:r.password,clientType:l.Bh.Web}).pipe((0,P.U)(function(e){var i;if(e.status.toUpperCase()!==l.qb.Success.toUpperCase())throw e;return o.credentialsService.setCredentials(i={project:r.project,username:r.username,token:e.body.token,userType:e.body.userType,tokenAge:e.body.tokenAge},r.remember),i}))},t.prototype.refresh=function(r){var o=this;return this.http.post("/api/auth/token",{userName:r.username,password:r.password}).pipe((0,P.U)(function(e){var i;if(e.status!==l.qb.Success)throw e;return o.credentialsService.setCredentials(i={project:r.project,username:r.username,token:e.body.token,userType:e.body.userType,tokenAge:e.body.tokenAge},r.remember),i}))},t.prototype.loginByFacebook=function(r){FB.getLoginStatus(function(i){m.debug(i),"connected"===i.status||FB.login(function(c){},{scope:"public_profile,email,user_likes,manage_pages"}),m.info("Test /me"),FB.api("/me",function(c){m.info(c)})});var e={project:r.project,username:r.username,token:"123456",userType:"Administrator",tokenAge:99999999999};return this.credentialsService.setCredentials(e,r.remember),(0,M.of)(e)},t.prototype.logout=function(){return this.credentialsService.setCredentials(),(0,M.of)(!0)},t.\u0275fac=function(o){return new(o||t)(n.LFG(T),n.LFG(S.eN),n.LFG(l.Uh))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),F=a(99597),_=a(6745),x=a(5473),q=a(85543),L=a(3932),v=function(t){return{"is-invalid":t}},f=new l.Yd("LoginComponent"),j=[{path:"",component:function(){function t(r,o,e,i,c,g){this.router=r,this.route=o,this.formBuilder=e,this.i18nService=i,this.authenticationService=c,this.globalService=g,this.version=_.N.version,this.isLoading=!1,this.storage=l.Nq.makeStorage(!0,"authentication"),this.createForm(),this.authenticationService.logout()}return t.prototype.ngOnInit=function(){var r=this.storage.get("rememberMe");r&&(this.loginForm.controls.rememberMe.setValue(!0),this.loginForm.controls.username.setValue(r));var o=this.storage.get("project");o&&(this.loginForm.controls.rememberMe.setValue(!0),this.loginForm.controls.project.setValue(o))},t.prototype.ngOnDestroy=function(){},t.prototype.login=function(r){return(0,u.mG)(this,void 0,void 0,function(){var o,i=this;return(0,u.Jh)(this,function(c){return o=this,this.isLoading=!0,this.authenticationService.login(this.loginForm.value).pipe((0,F.x)(function(){o.loginForm.markAsPristine(),o.isLoading=!1}),(0,x.tm)(o)).subscribe(function(g){f.debug(g.username+" successfully logged in"),o.router.navigate(["/entry"],{queryParams:(0,u.pi)((0,u.pi)({},o.route.snapshot.queryParams),{msg:g.username+" successfully logged in"})})},function(g){f.info(g),o.status=g.status,o.error=g.status!==l.qb.BadGateway?"Authentication.Username_or_password_incorrect":"Authentication.BadGateway",f.debug("Login error: "+g.errors)}).add(function(){f.info("Remember me "+i.loginForm.controls.rememberMe),i.loginForm.controls.rememberMe&&i.loginForm.controls.rememberMe.value?(i.storage.set("rememberMe",i.loginForm.controls.username.value),i.storage.set("project",i.loginForm.controls.project.value)):(i.storage.set("rememberMe",null),i.storage.set("project",null))}),[2]})})},t.prototype.goToPos=function(r){return(0,u.mG)(this,void 0,void 0,function(){return(0,u.Jh)(this,function(o){return this.isLoading=!0,this.router.navigateByUrl("/app/pos",{state:this.route.snapshot.queryParams}),this.isLoading=!1,[2]})})},t.prototype.setLanguage=function(r){this.i18nService.language=r},Object.defineProperty(t.prototype,"currentLanguage",{get:function(){return this.i18nService.language},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languages",{get:function(){return this.i18nService.supportedLanguages},enumerable:!1,configurable:!0}),t.prototype.createForm=function(){this.loginForm=this.formBuilder.group({project:[{value:"",disabled:this.isLoading},s.kI.required],username:[{value:"",disabled:this.isLoading},s.kI.required],password:[{value:"",disabled:this.isLoading},s.kI.required],remember:[{value:!0,disabled:this.isLoading}],rememberMe:[{value:!1,disabled:this.isLoading}]})},t.\u0275fac=function(o){return new(o||t)(n.Y36(p.F0),n.Y36(p.gz),n.Y36(s.qu),n.Y36(q.D),n.Y36(k),n.Y36(l.Uh))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-login"]],decls:58,vars:28,consts:[[1,"login-box"],[1,"app-name"],["translate","",1,"app-name"],[1,"language-selector"],[1,"container"],[1,"mx-auto","mt-3","card","col-md-6"],[1,"card-header"],[1,"card-body"],["novalidate","",3,"formGroup","ngSubmit"],["translate","",1,"alert","alert-danger",3,"hidden"],[1,"form-group"],[1,"input-group","form-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"bi","bi-umbrella"],["type","text","formControlName","project","autocomplete","project",1,"form-control",3,"ngClass","placeholder"],["translate","",1,"invalid-feedback",3,"hidden"],[1,"bi","bi-person"],["type","text","formControlName","username","autocomplete","username",1,"form-control",3,"ngClass","placeholder"],[1,"bi","bi-key"],["type","password","formControlName","password","autocomplete","current-password","required","",1,"form-control",3,"ngClass","placeholder"],[1,"remember"],["type","checkbox","formControlName","remember"],["translate",""],["type","submit",1,"float-right","btn","login_btn",3,"disabled"],[1,"fas","fa-cog","fa-spin",3,"hidden"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","#"],[1,"d-flex","justify-content-center"]],template:function(o,e){1&o&&(n.TgZ(0,"div"),n.TgZ(1,"div",0),n.TgZ(2,"div",1),n.TgZ(3,"h1",2),n._uU(4,"APP_NAME"),n.qZA(),n._UZ(5,"app-language-selector",3),n.qZA(),n.TgZ(6,"div",4),n.TgZ(7,"div",5),n.TgZ(8,"div",6),n.TgZ(9,"h3"),n._uU(10,"Sign In"),n.qZA(),n.qZA(),n.TgZ(11,"div",7),n.TgZ(12,"form",8),n.NdJ("ngSubmit",function(c){return e.login(c)}),n.TgZ(13,"div",9),n._uU(14," Username or password incorrect. "),n.qZA(),n.TgZ(15,"div",10),n.TgZ(16,"div",11),n.TgZ(17,"div",12),n.TgZ(18,"span",13),n._UZ(19,"i",14),n.qZA(),n.qZA(),n._UZ(20,"input",15),n.ALo(21,"translate"),n.TgZ(22,"div",16),n._uU(23," Project is required "),n.qZA(),n.qZA(),n.TgZ(24,"div",11),n.TgZ(25,"div",12),n.TgZ(26,"span",13),n._UZ(27,"i",17),n.qZA(),n.qZA(),n._UZ(28,"input",18),n.ALo(29,"translate"),n.TgZ(30,"div",16),n._uU(31," Username is required "),n.qZA(),n.qZA(),n.TgZ(32,"div",11),n.TgZ(33,"div",12),n.TgZ(34,"span",13),n._UZ(35,"i",19),n.qZA(),n.qZA(),n._UZ(36,"input",20),n.ALo(37,"translate"),n.TgZ(38,"div",16),n._uU(39," Password is required "),n.qZA(),n.qZA(),n.TgZ(40,"div",11),n.TgZ(41,"label",21),n._UZ(42,"input",22),n.TgZ(43,"span",23),n._uU(44,"Remember me"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(45,"div",10),n.TgZ(46,"button",24),n._UZ(47,"i",25),n.TgZ(48,"span",23),n._uU(49,"Login"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(50,"div",26),n.TgZ(51,"div",27),n._uU(52,"Don't have an account?"),n.TgZ(53,"a",28),n._uU(54,"Sign Up"),n.qZA(),n.qZA(),n.TgZ(55,"div",29),n.TgZ(56,"a",28),n._uU(57,"Forgot your password?"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&o&&(n.Gre("login-container bg-light v",e.version,""),n.xp6(12),n.Q6J("formGroup",e.loginForm),n.xp6(1),n.Q6J("hidden",!e.error||e.isLoading),n.xp6(7),n.Q6J("ngClass",n.VKq(22,v,!e.loginForm.controls.project.valid&&!e.loginForm.controls.project.untouched))("placeholder",n.lcZ(21,16,"Project")),n.xp6(2),n.Q6J("hidden",e.loginForm.controls.project.valid||e.loginForm.controls.project.untouched),n.xp6(6),n.Q6J("ngClass",n.VKq(24,v,!e.loginForm.controls.username.valid&&!e.loginForm.controls.username.untouched))("placeholder",n.lcZ(29,18,"Username")),n.xp6(2),n.Q6J("hidden",e.loginForm.controls.username.valid||e.loginForm.controls.username.untouched),n.xp6(6),n.Q6J("ngClass",n.VKq(26,v,!e.loginForm.controls.password.valid&&!e.loginForm.controls.password.untouched))("placeholder",n.lcZ(37,20,"Password")),n.xp6(2),n.Q6J("hidden",e.loginForm.controls.password.valid||e.loginForm.controls.password.untouched),n.xp6(8),n.Q6J("disabled",e.loginForm.invalid||e.isLoading),n.xp6(1),n.Q6J("hidden",!e.isLoading))},directives:[h.Pi,L.S,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,C.mk,s.Q7,s.Wl],pipes:[h.X$],styles:['.badge-outline-primary[_ngcontent-%COMP%]{border:1px solid #0066ff;color:#06f!important;background:transparent!important}.badge-outline-secondary[_ngcontent-%COMP%]{border:1px solid #6c757d;color:#6c757d!important;background:transparent!important}.badge-outline-success[_ngcontent-%COMP%]{border:1px solid #28a745;color:#28a745!important;background:transparent!important}.badge-outline-info[_ngcontent-%COMP%]{border:1px solid #17a2b8;color:#17a2b8!important;background:transparent!important}.badge-outline-warning[_ngcontent-%COMP%]{border:1px solid #ffc107;color:#ffc107!important;background:transparent!important}.badge-outline-danger[_ngcontent-%COMP%]{border:1px solid #de3163;color:#de3163!important;background:transparent!important}.badge-outline-light[_ngcontent-%COMP%]{border:1px solid #f8f9fa;color:#f8f9fa!important;background:transparent!important}.badge-outline-dark[_ngcontent-%COMP%]{border:1px solid #343a40;color:#343a40!important;background:transparent!important}.alert-outline-primary[_ngcontent-%COMP%]{border:1px solid #0066ff;color:#06f!important;background:transparent!important}.alert-outline-secondary[_ngcontent-%COMP%]{border:1px solid #6c757d;color:#6c757d!important;background:transparent!important}.alert-outline-success[_ngcontent-%COMP%]{border:1px solid #28a745;color:#28a745!important;background:transparent!important}.alert-outline-info[_ngcontent-%COMP%]{border:1px solid #17a2b8;color:#17a2b8!important;background:transparent!important}.alert-outline-warning[_ngcontent-%COMP%]{border:1px solid #ffc107;color:#ffc107!important;background:transparent!important}.alert-outline-danger[_ngcontent-%COMP%]{border:1px solid #de3163;color:#de3163!important;background:transparent!important}.alert-outline-light[_ngcontent-%COMP%]{border:1px solid #f8f9fa;color:#f8f9fa!important;background:transparent!important}.alert-outline-dark[_ngcontent-%COMP%]{border:1px solid #343a40;color:#343a40!important;background:transparent!important}.invalid-feedback[hidden][_ngcontent-%COMP%]{display:inline-block!important;visibility:hidden}.login-container[_ngcontent-%COMP%]{position:fixed;top:0;bottom:0;left:0;right:0;background-image:url(/assets/login-wallpaper.jpg);background-size:cover;background-repeat:no-repeat;height:100%;font-family:"Numans",sans-serif}.login-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.login-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{margin:0 5px 0 0;color:var(--white)}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;min-height:100%}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto;background-color:#00000080!important}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:0}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--white)}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:var(--yellow);color:var(--white);border:0!important}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   label.remember[_ngcontent-%COMP%]{margin:0;display:inline-flex;color:var(--white)}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   label.remember[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;color:var(--yellow);margin-right:5px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .login_btn[_ngcontent-%COMP%]{background-color:var(--yellow);color:#fff;min-width:100px}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .login_btn[_ngcontent-%COMP%]:not([disabled]):hover{background-color:var(--white);color:#000}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{color:var(--white)}.login-container[_ngcontent-%COMP%]   .login-box[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}@media (max-width: 575.98px){.container[_ngcontent-%COMP%]{width:100%}}']}),t}(),data:{title:(0,y.J)("Login")}}],w=function(){function t(){}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({providers:[],imports:[[p.Bz.forChild(j)],p.Bz]}),t}(),J=function(){function t(){}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[C.ez,s.UX,h.aw,Z.IJ,O.L,w]]}),t}()}}]);